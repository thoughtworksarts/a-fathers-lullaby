language: node_js
node_js:
- stable
addons:
  apt:
    packages:
    - libgconf-2-4
cache:
  npm: true
  directories:
  - "~/.cache"
  - node_modules
before_install: "./build-env.sh"
install:
- npm install
- npm ci
script:
- npm run cypress:headless
- npm test a
- npm run build
deploy:
- provider: pages
  skip_cleanup: true
  github_token: "$github_token"
  local_dir: build
  on:
    branch: release
- provider: surge
  skip_cleanup: true
  project: "./build/"
  domain: a-fathers-lullaby.surge.sh
  on:
    branch: master
branches:
  only:
  - master
  - release
env:
  global:
    secure: 06N5S4iuVFQYFIvfq/kr2hmtOpcrPM6Oyl/gbrO+Uzfwz1ffPbRsgqxFol04tWOikWjl1gbtiOioM/RvSkvdcVGuDZUbU5A5xBJAb+daRtNGf1/1gtimTJ/KH42LjfRvdz23zqq+t0sFbq+w9vl1ZNxHbnxvQzeGW9TVGqJqL2NDptG4tuvsjbgAoTLt8pY8g0eXaHduxSVGW2pEFCa1He4pLYiHd/pOx3kTaWxSTUNwfgtdy8a4w+9lU8K826uESFBf1sESVPh/xm1L80+uhU+pJSUUmohgVC3FsFbcqAC+Y8UKF/DsMXQA11UIdFKmTTyXSjo+fYB97c1o4Bpt4goudkaUjc14SCQV7K+B5N5stTvMmZSVT0sJPK9/WFiqY6wyGPDtuOU8K/j9mCXvPNbM0CfucbyVQ4YqGZnKQObtz7jdYc/TsnewVWoLlPZ9rBp2cilIUSfu6biBJFBgwxUWqJ+6jEXHxfWdU4i+oGsP3TJlYkSV8jjaqRV9Po3gUpgsu9KzX/8Cx6Rcd4NkzDJ4kiFGMHfDUMY0oU44aEYsHdOeZLRq1MUUCwwMaPTA8r7ICrCOGW2AsY1F36UaES6mFMj9+QP+zhk1xxhEiEOlxy0TkyEpvtpz0xYj13ti1cb9PcJvJc+yB6aXdhFyeRp45fERUVxU/Ilpx0Syl40=
